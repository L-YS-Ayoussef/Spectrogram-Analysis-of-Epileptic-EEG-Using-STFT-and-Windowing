# üß† Spectrogram Analysis of Epileptic EEG Using STFT and Windowing

## üåç Overview

This project builds an analytical system for **EEG spectrogram analysis** using the **Short-Time Fourier Transform (STFT)** implemented from scratch with MATLAB‚Äôs `fft()` function. The system works on epileptic electroencephalography (EEG) recordings from the CHB-MIT database and focuses on comparing **seizure (ictal)** and **seizure-free (interictal)** states.

The core goals are to:

- Implement a spectrogram generator using STFT and FFT.
- Investigate the impact of **window size**, **window type**, and **overlapping ratio** on the spectrogram representation.
- Understand the trade-off between **time resolution** and **frequency resolution** in practical EEG analysis.

All code is implemented in MATLAB (`.m` and `.mlx` files), and the project operates on multi-channel EEG data sampled at **256 Hz**.

## ‚ú® Features

- **Objective 1 ‚Äì Spectrogram & STFT Implementation**
  - Understanding spectrograms conceptually and programmatically.
  - Implementing STFT from scratch using the FFT (`fft`) function.
  - Converting multi-channel EEG signals into time‚Äìfrequency representations.

- **Objective 2 ‚Äì Time‚ÄìFrequency Resolution & Window Study**
  - Investigating the effect of:
    - Window size (number of samples in each STFT frame),
    - Window type (Rectangular, Triangular, Hamming, Blackman),
    - Overlapping ratio between consecutive frames.
  - Exploring the trade-off between **time resolution** and **frequency resolution**.

- **Project Context ‚Äì Epileptic EEG**
  - Working with EEG recordings from a patient with epilepsy.
  - Separating seizure-only (ictal) data and seizure-free (interictal) data.
  - Supporting flexible channel selection and averaging.

- **Notebook Summary**
  - A MATLAB Live Script `DSP_Assignment.mlx` provides a **notebook-style walkthrough** of all project tasks in order, combining code, explanations, and results.

## üß© Project Parts

Below is a brief explanation of each task/part and the main files involved.

---

### I. Pre-processing

#### 1Ô∏è‚É£ Importing and Organizing EEG Records

Raw `EEG data` for the same patient are provided as:

- `chb12_29_data.mat`  
- `chb12_29_header.mat`  
- `chb12_32_data.mat`  
- `chb12_32_header.mat`  
- `chb12-summary.txt`

In this step:

- The raw CHB-MIT EEG records are imported and read.
- `chb12_29_data.mat` (contains 6 seizures) and `chb12_32_data.mat` (seizure-free) are loaded.
- Using `chb12-summary.txt`, only the **ictal (seizure) segments** are extracted from `chb12_29_data.mat` to form seizure-only data.
- A seizure-free record is taken from `chb12_32_data.mat`.

**Main files involved:**

- `ReadEDF.m`, `EdfToMat.m`, `SaveEDF.m` ‚Äì Reading and converting EDF data to MATLAB `.mat` format.
- `reading_Data.m` ‚Äì High-level script for loading EEG data and headers.
- `chb12_29_data.mat`, `chb12_29_header.mat`, `chb12_32_data.mat`, `chb12_32_header.mat`, `chb12-summary.txt` ‚Äì Raw and annotation files.
- `ictal_data.mat`, `seizure_free_data.mat` ‚Äì Processed datasets containing ictal and seizure-free segments.

---

#### 2Ô∏è‚É£ Channel Selection and Averaging

The EEG data are **multi-channel**, each channel corresponding to a different electrode.

In this step:

- The user can **select specific channels** (via text or check box interface).
- The selected channels are averaged to produce a **single representative EEG signal** per state (ictal / seizure-free).

**Main files involved:**

- `user.m` ‚Äì User interface / control logic (channel selection and options).
- `reading_Data.m` ‚Äì Provides the loaded multi-channel EEG data.
- `ictal_averaged.mat`, `seizure_free_averaged.mat` ‚Äì Averaged single-channel ictal and seizure-free signals.

---

### II. Spectrogram Construction (STFT-Based)

All EEG signals are sampled at **256 Hz**. The spectrogram is generated by segmenting the pre-processed signal into windows of **n seconds**, applying a window function, and computing the FFT of each segment.

The STFT is implemented **manually** using `fft()` inside:

- `compute_spectrogram.m`
- `spectrography.m`

and analyzed/visualized using:

- `spectrogram_analysis.m`
- `windowing_analysis.m`

---

#### 3Ô∏è‚É£ Time & Frequency Resolution

**Task:**  
Investigate different choices of **time resolution** and **frequency resolution**.

- **Time resolution** is determined by the **window length** in samples (number of time-domain samples passed into each STFT frame).
- **Frequency resolution** is tied to the **number of frequency bins**, which depends on the FFT length and sampling frequency.

**Trade-off (explained briefly):**

- Shorter windows ‚Üí **better time resolution**, **poorer frequency resolution**.
- Longer windows ‚Üí **better frequency resolution**, **poorer time resolution**.

**Main files involved:**

- `compute_spectrogram.m` ‚Äì Core STFT + spectrogram computation.
- `spectrography.m` ‚Äì Script for experimenting with different resolutions.
- `spectrogram_analysis.m` ‚Äì Visualization and comparison of different (time, frequency) settings.

---

#### 4Ô∏è‚É£ Overlapping Ratio

**Task:**  
Add an option for **overlapping** between consecutive time windows and study its effect.

- Overlapping ratio = (number of overlapped samples) / (total window samples).
- Higher overlap ‚Üí smoother spectrogram and less time aliasing, at the cost of more computation.
- No or low overlap ‚Üí faster but may look more ‚Äúblocky‚Äù in time.

**Main files involved:**

- `compute_spectrogram.m` ‚Äì Implements overlapping logic.
- `spectrography.m`, `windowing_analysis.m` ‚Äì Experiments and plots for different overlap settings.

---

#### 5Ô∏è‚É£ Window Size

**Task:**  
Vary the **window size** (number of samples per STFT frame) and examine:

- How longer/shorter windows affect the sharpness of frequency bands.
- The trade-off in detecting short transient events vs. precise frequency content.

**Main files involved:**

- `windowing_analysis.m` ‚Äì Focused analysis of different window sizes.
- `spectrogram_analysis.m` ‚Äì Displays spectrograms for varying window sizes.

---

#### 6Ô∏è‚É£ Window Types and Parameters

**Task:**  
Apply and compare several window functions:

- Rectangular window (no window)  
- Triangular window  
- Hamming window  
- Blackman window  

and investigate how their shapes and parameters affect side lobes and leakage in the spectrogram.

Let M be the window length (number of samples minus 1) and \( i = 0, 1, ....., M \).

**Hamming Window:**

\[
w[i] = 0.54 - 0.46 cos\(2œÄi / M\)
\]

**Blackman Window:**

\[
w[i] = 0.42 - 0.5 cos\(2œÄ*i / M\) + 0.08 cos\(4œÄ*i / M\)
\]

These windows are applied to each time frame before computing the FFT in the STFT.

**Main files involved:**

- `compute_spectrogram.m` ‚Äì Applies the selected window function.
- `windowing_analysis.m` ‚Äì Compares Rectangular, Triangular, Hamming, and Blackman windows.
- `spectrography.m`, `spectrogram_analysis.m` ‚Äì Visual inspection of the spectrograms under different windows.

---

### III. Plotting & Visualization

#### 7Ô∏è‚É£ Spectrogram Display

**Task:**  
Display and compare the spectrograms for all investigated configurations:

- Different time/frequency resolutions.
- Different overlapping ratios.
- Different window types and sizes.
- Comparison between **ictal** and **seizure-free** signals.

The spectrogram plots are mainly produced using:

- `spectrogram_analysis.m`
- `windowing_analysis.m`
- `spectrography.m`

and are orchestrated in the notebook:

- `DSP_Assignment.mlx` ‚Äì **Live Script notebook** that documents and runs **all project tasks** end-to-end, combining:
  - Data loading
  - Pre-processing
  - Spectrogram computation
  - Parameter studies
  - Plotting and discussion

---

### üîß Utility & Support Files

- `user.m` ‚Äì User interface / control script (channel selection and parameter input).
- `EdfToMat.m`, `ReadEDF.m`, `SaveEDF.m` ‚Äì EDF ‚Üî MAT conversion utilities.
- `ictal_data.mat`, `seizure_free_data.mat` ‚Äì Extracted ictal and seizure-free records.
- `ictal_averaged.mat`, `seizure_free_averaged.mat` ‚Äì Channel-averaged versions of the above.
- `spectrogram_analysis.m`, `spectrography.m`, `windowing_analysis.m` ‚Äì Analysis and visualization scripts for different experimental setups.

---

## üìÑ License

‚ö†Ô∏è **Important Notice:** This repository is publicly available for viewing only. Forking, cloning, or redistributing this project is **NOT** permitted without explicit permission.

Copyright (c) 2025 Chameleon Tech
